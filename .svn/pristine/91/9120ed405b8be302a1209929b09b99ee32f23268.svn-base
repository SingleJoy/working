<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.bnsr.edu_yun.backstage.base.mapper.MenuMapper">
  <resultMap id="BaseResultMap" type="cn.bnsr.edu_yun.backstage.base.po.Menu">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="iconcls" jdbcType="VARCHAR" property="iconcls" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="seq" jdbcType="DECIMAL" property="seq" />
    <result column="url" jdbcType="VARCHAR" property="url" />
    <result column="pid" jdbcType="VARCHAR" property="pid" />
    <result column="isopen" jdbcType="INTEGER" property="isopen" />
    <result column="shownotice" jdbcType="INTEGER" property="shownotice" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    id, iconcls, name, seq, url, pid, isopen, shownotice
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from menu
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    delete from menu
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="cn.bnsr.edu_yun.backstage.base.po.Menu">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into menu (iconcls, name, seq, 
      url, pid, isopen, shownotice
      )
    values (#{iconcls,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR}, #{seq,jdbcType=DECIMAL}, 
      #{url,jdbcType=VARCHAR}, #{pid,jdbcType=VARCHAR}, #{isopen,jdbcType=INTEGER}, #{shownotice,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="cn.bnsr.edu_yun.backstage.base.po.Menu">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into menu
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="iconcls != null">
        iconcls,
      </if>
      <if test="name != null">
        name,
      </if>
      <if test="seq != null">
        seq,
      </if>
      <if test="url != null">
        url,
      </if>
      <if test="pid != null">
        pid,
      </if>
      <if test="isopen != null">
        isopen,
      </if>
      <if test="shownotice != null">
        shownotice,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="iconcls != null">
        #{iconcls,jdbcType=VARCHAR},
      </if>
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="seq != null">
        #{seq,jdbcType=DECIMAL},
      </if>
      <if test="url != null">
        #{url,jdbcType=VARCHAR},
      </if>
      <if test="pid != null">
        #{pid,jdbcType=VARCHAR},
      </if>
      <if test="isopen != null">
        #{isopen,jdbcType=INTEGER},
      </if>
      <if test="shownotice != null">
        #{shownotice,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="cn.bnsr.edu_yun.backstage.base.po.Menu">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    update menu
    <set>
      <if test="iconcls != null">
        iconcls = #{iconcls,jdbcType=VARCHAR},
      </if>
      <if test="name != null">
        name = #{name,jdbcType=VARCHAR},
      </if>
      <if test="seq != null">
        seq = #{seq,jdbcType=DECIMAL},
      </if>
      <if test="url != null">
        url = #{url,jdbcType=VARCHAR},
      </if>
      <if test="pid != null">
        pid = #{pid,jdbcType=VARCHAR},
      </if>
      <if test="isopen != null">
        isopen = #{isopen,jdbcType=INTEGER},
      </if>
      <if test="shownotice != null">
        shownotice = #{shownotice,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="cn.bnsr.edu_yun.backstage.base.po.Menu">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 28 17:30:52 CST 2016.
    -->
    update menu
    set iconcls = #{iconcls,jdbcType=VARCHAR},
      name = #{name,jdbcType=VARCHAR},
      seq = #{seq,jdbcType=DECIMAL},
      url = #{url,jdbcType=VARCHAR},
      pid = #{pid,jdbcType=VARCHAR},
      isopen = #{isopen,jdbcType=INTEGER},
      shownotice = #{shownotice,jdbcType=INTEGER}
    where id = #{id,jdbcType=BIGINT}
  </update>
  
  <select id="queryTree" parameterType="cn.bnsr.edu_yun.backstage.base.po.Menu" resultType="cn.bnsr.edu_yun.backstage.base.po.Menu">
   	SELECT 
    <include refid="Base_Column_List" />
    FROM menu m 
    <if test="id != null and id !=''">
    	WHERE	m.pid = #{id}
    </if>
    <if test="id == null">
   	 	WHERE	m.pid is null
    </if>
    ORDER BY m.seq
  </select>
  
  <select id="queryTreeGrid" parameterType="cn.bnsr.edu_yun.backstage.base.po.Menu" resultType="cn.bnsr.edu_yun.backstage.base.view.TreeView">
  	SELECT mm.id as id, mm.iconcls as iconcls, mm.name as name, mm.seq as seq,
  		mm.url as url, t.id as pid, t.name as pname
  	FROM menu mm 
  	LEFT JOIN  (SELECT m.id,m.name FROM menu m) t  
  	ON mm.pid= t.id
  	<if test="id != null and id !=''">
  		WHERE	mm.pid = #{id}
  	</if>
  	<if test="id == null">
 		WHERE	mm.pid is null
	</if> 
	ORDER BY mm.seq 
  </select>
  
  <select id="countChildren" parameterType="java.lang.String" resultType="java.lang.Long">
  	SELECT COUNT(*) FROM menu t where t.pid = #{pid}
  </select>
</mapper>